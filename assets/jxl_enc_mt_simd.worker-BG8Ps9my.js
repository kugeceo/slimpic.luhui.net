var a={},d=!1;function l(){var e=Array.prototype.slice.call(arguments).join(" ");console.error(e)}function o(){var e=Array.prototype.slice.call(arguments).join(" ");postMessage({cmd:"alert",text:e,threadId:a._pthread_self()})}var i=l;self.alert=o;a.instantiateWasm=(e,r)=>{var t=a.wasmModule;a.wasmModule=null;var s=new WebAssembly.Instance(t,e);return r(s)};self.onunhandledrejection=e=>{throw e.reason??e};function n(e){try{if(e.data.cmd==="load"){let r=[];self.onmessage=t=>r.push(t),self.startWorker=t=>{a=t,postMessage({cmd:"loaded"});for(let s of r)n(s);self.onmessage=n},a.wasmModule=e.data.wasmModule;for(const t of e.data.handlers)a[t]=function(){postMessage({cmd:"callHandler",handler:t,args:[...arguments]})};a.wasmMemory=e.data.wasmMemory,a.buffer=a.wasmMemory.buffer,a.ENVIRONMENT_IS_PTHREAD=!0,(e.data.urlOrBlob?import(e.data.urlOrBlob):import("./jxl_enc_mt_simd-DEdtdPQy.js")).then(t=>t.default(a))}else if(e.data.cmd==="run"){a.__emscripten_thread_init(e.data.pthread_ptr,0,0,1),a.__emscripten_thread_mailbox_await(e.data.pthread_ptr),a.establishStackSpace(),a.PThread.receiveObjectTransfer(e.data),a.PThread.threadInitTLS(),d||(a.__embind_initialize_bindings(),d=!0);try{a.invokeEntryPoint(e.data.start_routine,e.data.arg)}catch(r){if(r!="unwind")throw r}}else e.data.cmd==="cancel"?a._pthread_self()&&a.__emscripten_thread_exit(-1):e.data.target==="setimmediate"||(e.data.cmd==="checkMailbox"?d&&a.checkMailbox():e.data.cmd&&(i("worker.js received unknown command "+e.data.cmd),i(e.data)))}catch(r){throw a.__emscripten_thread_crashed&&a.__emscripten_thread_crashed(),r}}self.onmessage=n;
